<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Desktop Botanical 3D Viewer</title>
<style>
  html, body { margin:0; padding:0; height:100%; overflow:hidden; background:#000; font-family: Arial, system-ui; }
  #viewer { width:100%; height:100%; position:relative; }
  #sorryBtn { position:absolute; right:20px; bottom:20px; z-index:10; background:#222; border:1px solid #555; padding:10px 12px; border-radius:8px; cursor:pointer; color:#fff; font-size:16px; }
  #sorryOverlay { position:absolute; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.85); display:flex; justify-content:center; align-items:center; text-align:center; color:#fff; font-size:18px; padding:20px; box-sizing:border-box; display:none; z-index:999; }
</style>
</head>
<body>

<div id="viewer"></div>
<button id="sorryBtn">ðŸ”’</button>
<div id="sorryOverlay">
  <div id="sorryMessage"></div>
</div>

<script type="module">
import * as THREE from 'https://cdn.jsdelivr.net/npm/three@0.160.0/build/three.module.js';
import { OrbitControls } from 'https://cdn.jsdelivr.net/npm/three@0.160.0/examples/jsm/controls/OrbitControls.js';
import { MTLLoader } from 'https://cdn.jsdelivr.net/npm/three@0.160.0/examples/jsm/loaders/MTLLoader.js';
import { OBJLoader } from 'https://cdn.jsdelivr.net/npm/three@0.160.0/examples/jsm/loaders/OBJLoader.js';

// ---- Scene Setup ----
const container = document.getElementById('viewer');
const scene = new THREE.Scene();
scene.background = new THREE.Color(0x000000);

// Camera
const camera = new THREE.PerspectiveCamera(45, window.innerWidth/window.innerHeight, 0.1, 1000);
camera.position.set(0, 1.2, 3);

// Renderer
const renderer = new THREE.WebGLRenderer({antialias:true});
renderer.setSize(window.innerWidth, window.innerHeight);
container.appendChild(renderer.domElement);

// Controls
const controls = new OrbitControls(camera, renderer.domElement);
controls.enableDamping = true;
controls.dampingFactor = 0.08;
controls.minDistance = 0.8;
controls.maxDistance = 20;

// Lights
const hemi = new THREE.HemisphereLight(0xffffff, 0x222222, 0.9); scene.add(hemi);
const dir = new THREE.DirectionalLight(0xffffff, 0.5); dir.position.set(3,5,2); scene.add(dir);

// Ground
const ground = new THREE.Mesh(
  new THREE.PlaneGeometry(30,30),
  new THREE.MeshStandardMaterial({color:0x080808, roughness:1})
);
ground.rotation.x = -Math.PI/2; ground.position.y = -0.6; scene.add(ground);

// ---- Load OBJ/MTL Model ----
const mtlLoader = new MTLLoader();
mtlLoader.load('models/rose/rose.mtl', (materials) => {
  materials.preload();
  const objLoader = new OBJLoader();
  objLoader.setMaterials(materials);
  objLoader.load('models/rose/rose.obj', (object) => {
    object.position.y = 0;
    object.scale.set(1,1,1);
    scene.add(object);
  }, undefined, (err) => {
    console.error('OBJ load error:', err);
  });
});

// ---- Animation Loop ----
function animate(){
  requestAnimationFrame(animate);
  controls.update();
  renderer.render(scene, camera);
}
animate();

// ---- Handle Resize ----
window.addEventListener('resize', ()=>{
  camera.aspect = window.innerWidth/window.innerHeight;
  camera.updateProjectionMatrix();
  renderer.setSize(window.innerWidth, window.innerHeight);
});

// ---- Sorry Mode ----
const sorryBtn = document.getElementById('sorryBtn');
const sorryOverlay = document.getElementById('sorryOverlay');
const sorryMessage = document.getElementById('sorryMessage');
let clickCount = 0;
const maxClicks = 22;
const message = `I am truly sorry for all the moments I may have hurt or disappointed you. 
I want you to know that you mean everything to me, and I deeply regret any pain I've caused. 
I love you, and I promise to do better every single day.`;

sorryBtn.addEventListener('click', ()=>{
  clickCount++;
  if(clickCount >= maxClicks){
    sorryOverlay.style.display = 'flex';
    sorryMessage.textContent = message;
  }
});

sorryOverlay.addEventListener('click', ()=>{
  sorryOverlay.style.display = 'none';
  clickCount = 0;
});
</script>
</body>
</html>
